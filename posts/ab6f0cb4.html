

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png">
  <link rel="icon" href="/img/avatar.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Peixuan Hu">
  <meta name="keywords" content="">
  
    <meta name="description" content="1. Information Is Bits + Context12345678&#x2F;* hello.c *&#x2F;#include &lt;stdio.h&gt;int main()&amp;#123;	printf(&quot;hello, world\n&quot;);	return 0;&amp;#125;  The representation of hello.c illustrates a fundament">
<meta property="og:type" content="article">
<meta property="og:title" content="CSAPP - Chapter 1 - A Tour of Computer Systems">
<meta property="og:url" content="https://peixuanhu.github.io/posts/ab6f0cb4.html">
<meta property="og:site_name" content="Peixuan&#39;s Page">
<meta property="og:description" content="1. Information Is Bits + Context12345678&#x2F;* hello.c *&#x2F;#include &lt;stdio.h&gt;int main()&amp;#123;	printf(&quot;hello, world\n&quot;);	return 0;&amp;#125;  The representation of hello.c illustrates a fundament">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.loli.net/2024/11/11/iEILBt8dcWAku7b.png">
<meta property="article:published_time" content="2024-11-10T15:26:47.000Z">
<meta property="article:modified_time" content="2025-05-18T17:08:32.977Z">
<meta property="article:author" content="Peixuan Hu">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://s2.loli.net/2024/11/11/iEILBt8dcWAku7b.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>CSAPP - Chapter 1 - A Tour of Computer Systems - Peixuan&#39;s Page</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"peixuanhu.github.io","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":6},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Peixuan&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://s2.loli.net/2024/11/11/iEILBt8dcWAku7b.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CSAPP - Chapter 1 - A Tour of Computer Systems"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-11-10 23:26" pubdate>
          November 10, 2024 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          17k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          143 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">CSAPP - Chapter 1 - A Tour of Computer Systems</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="1-Information-Is-Bits-Context"><a href="#1-Information-Is-Bits-Context" class="headerlink" title="1. Information Is Bits + Context"></a>1. Information Is Bits + Context</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/* hello.c */</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello, world\n&quot;</span>);<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>The representation of <code>hello.c</code> illustrates a fundamental idea: All information in a system—including disk files, programs stored in memory, user data stored in memory, and data transferred across a network—is represented as a bunch of bits. The only thing that distinguishes different data objects is the context in which we view them.</p>
<blockquote>
<p>For example, in different contexts, the same sequence of bytes might represent an integer, floating-point number, character string, or machine instruction.</p>
</blockquote>
<h2 id="Origins-of-the-C-programming-language"><a href="#Origins-of-the-C-programming-language" class="headerlink" title="Origins of the C programming language"></a>Origins of the C programming language</h2><p>C was developed from 1969 to 1973 by Dennis Ritchie of Bell Laboratories. The American National Standards Institute (ANSI) ratified the ANSI C standard in 1989, and this standardization later became the responsibility of the International Standards Organization (ISO). The standards define the C language and a set of library functions known as the C standard library.Kernighan and Ritchie describe ANSI C in their classic book, which is known affectionately as <strong>“K&amp;R”</strong>(B. Kernighan and D. Ritchie. The C Programming Language, Second Edition. Prentice Hall, 1988.). </p>
<p>In Ritchie’s words, C is “quirky, flawed, and an enormous success.” So why the success?</p>
<ul>
<li><strong>C was closely tied with the Unix operating system.</strong> C was developed from the beginning as the system programming language for Unix. Most of the Unix kernel (the core part of the operating system), and all of its supporting tools and libraries, were written in C.</li>
<li><strong>C is a small, simple language.</strong> The design was controlled by a single person, rather than a committee, and the result was a clean, consistent design with little baggage. The K&amp;R book describes the complete language and standard library, with numerous examples and exercises, in only 261 pages. The simplicity of C made it relatively easy to learn and to port to different computers.</li>
<li><strong>C was designed for a practical purpose.</strong> C was designed to implement the Unix operating system. Later, other people found that they could write the programs they wanted, without the language getting in the way.<blockquote>
<p>C is the language of choice for system-level programming, and there is a huge installed base of application-level programs as well. However, it is not perfect for all programmers and all situations. C pointers are a common source of confusion and programming errors. C also lacks explicit support for useful abstractions such as classes, objects, and exceptions. Newer languages such as C++ and Java address these issues for application-level programs.</p>
</blockquote>
</li>
</ul>
<h1 id="2-Programs-Are-Translated-by-Other-Programs-into-Different-Forms"><a href="#2-Programs-Are-Translated-by-Other-Programs-into-Different-Forms" class="headerlink" title="2. Programs Are Translated by Other Programs into Different Forms"></a>2. Programs Are Translated by Other Programs into Different Forms</h1><p>On a Unix system, the translation from source file to object file is performed by a compiler driver:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">linux&gt; </span><span class="language-bash">gcc -o hello hello.c</span><br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/11/10/xdw5oimXcuTUHzP.png" srcset="/img/loading.gif" lazyload alt="the compilation system.png"></p>
<p>The translation is performed in the sequence of four phases. The programs that perform the four phases (<em>preprocessor</em>, <em>compiler</em>, <em>assembler</em>, and <em>linker</em>) are known collectively as the <em>compilation system</em>.</p>
<h2 id="Preprocessing-phase"><a href="#Preprocessing-phase" class="headerlink" title="Preprocessing phase"></a>Preprocessing phase</h2><p>The preprocessor (cpp) modifies the original C program according to directives that begin with the ‘#’ character. For example, the <code>#include &lt;stdio.h&gt;</code> command in line 1 of <code>hello.c</code> tells the preprocessor to read the contents of the system header file <code>stdio.h</code> and insert it directly into the program text. The result is another C program, typically with the .i suffix.</p>
<h2 id="Compilation-phase"><a href="#Compilation-phase" class="headerlink" title="Compilation phase"></a>Compilation phase</h2><p>The compiler (cc1) translates the text file <code>hello.i</code> into the text file <code>hello.s</code>, which contains an assembly-language program. This program includes the following definition of function main:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs assembly">main:<br>	subq $8, %rsp<br>	movl $.LC0, %edi<br>	call puts<br>	movl $0, %eax<br>	addq $8, %rsp<br>	ret<br></code></pre></td></tr></table></figure>

<blockquote>
<p>Assembly language is useful because it provides a common output language for different compilers for different high-level languages. For example, C compilers and Fortran compilers both generate output files in the same assembly language.</p>
</blockquote>
<h2 id="Assembly-phase"><a href="#Assembly-phase" class="headerlink" title="Assembly phase"></a>Assembly phase</h2><p>Next, the assembler (as) translates hello.s into machine language instructions, packages them in a form known as a relocatable object program, and stores the result in the object file <code>hello.o</code>. This file is a binary file containing 17 bytes to encode the instructions for function main. If we were to view <code>hello.o</code> with a text editor, it would appear to be gibberish.</p>
<h2 id="Linking-phase"><a href="#Linking-phase" class="headerlink" title="Linking phase"></a>Linking phase</h2><p>Notice that our hello program calls the <code>printf</code> function, which is part of the standard C library provided by every C compiler. The printf function resides in a separate precompiled object file called <code>printf.o</code>, which must somehow be merged with our <code>hello.o</code> program. The linker (ld) handles this merging. The result is the <code>hello</code> file, which is an executable object file (or simply executable) that is ready to be loaded into memory and executed by the system.</p>
<h1 id="3-It-Pays-to-Understand-How-Compilation-Systems-Work"><a href="#3-It-Pays-to-Understand-How-Compilation-Systems-Work" class="headerlink" title="3. It Pays to Understand How Compilation Systems Work"></a>3. It Pays to Understand How Compilation Systems Work</h1><p>There are some important reasons why programmers need to understand how compilation systems work:</p>
<h2 id="Optimizing-program-performance"><a href="#Optimizing-program-performance" class="headerlink" title="Optimizing program performance"></a>Optimizing program performance</h2><p>In order to make good coding decisions in our C programs, we do need a basic understanding of machine-level code and how the compiler translates different C statements into machine code.</p>
<blockquote>
<p>For example, is a switch statement always more efficient than a sequence of if-else statements? How much overhead is incurred by a function call? Is a while loop more efficient than a for loop? Are pointer references more efficient than array indexes? Why does our loop run so much faster if we sum into a local variable instead of an argument that is passed by reference? How can a function run faster when we simply rearrange the parentheses in an arithmetic expression?</p>
</blockquote>
<h2 id="Understanding-link-time-errors"><a href="#Understanding-link-time-errors" class="headerlink" title="Understanding link-time errors"></a>Understanding link-time errors</h2><p>In our experience, some of the most perplexing programming errors are related to the operation of the linker, especially when you are trying to build large software systems.</p>
<blockquote>
<p>For example, what does it mean when the linker reports that it cannot resolve a reference?What is the difference between a static variable and a global variable? What happens if you define two global variables in different C files with the same name?What is the difference between a static library and a dynamic library? Why does it matter what order we list libraries on the command line? And scariest of all, why do some linker-related errors not appear until run time?</p>
</blockquote>
<h2 id="Avoiding-security-holes"><a href="#Avoiding-security-holes" class="headerlink" title="Avoiding security holes"></a>Avoiding security holes</h2><p>For many years, <em>buffer overflow vulnerabilities</em> have accounted for many of the security holes in network and Internet servers. These vulnerabilities exist because too few programmers understand the need to <strong>carefully restrict the quantity and forms of data they accept from untrusted sources</strong>. A first step in learning secure programming is to understand the consequences of the way data and control information are stored on the program stack.</p>
<h1 id="4-Processors-Read-and-Interpret-Instructions-Stored-in-Memory"><a href="#4-Processors-Read-and-Interpret-Instructions-Stored-in-Memory" class="headerlink" title="4. Processors Read and Interpret Instructions Stored in Memory"></a>4. Processors Read and Interpret Instructions Stored in Memory</h1><h2 id="Hardware-Organization-of-a-System"><a href="#Hardware-Organization-of-a-System" class="headerlink" title="Hardware Organization of a System"></a>Hardware Organization of a System</h2><p><img src="https://s2.loli.net/2024/11/11/iEILBt8dcWAku7b.png" srcset="/img/loading.gif" lazyload alt="Hardware organization of a typical system.png"></p>
<h3 id="Buses"><a href="#Buses" class="headerlink" title="Buses"></a>Buses</h3><p>Running throughout the system is a collection of electrical conduits called buses that carry bytes of information back and forth between the components. Buses are typically designed to transfer fixed-size chunks of bytes known as <code>words</code>.</p>
<h3 id="I-O-Devices"><a href="#I-O-Devices" class="headerlink" title="I&#x2F;O Devices"></a>I&#x2F;O Devices</h3><p>Each I&#x2F;O device is connected to the I&#x2F;O bus by either a <code>controller</code> or an <code>adapter</code>. The distinction between the two is mainly one of packaging.<br>Controllers are chip sets in the device itself or on the system’s main printed circuit board (often called the motherboard).<br>An adapter is a card that plugs into a slot on the motherboard.<br>Regardless, the purpose of each is to transfer information back and forth between the I&#x2F;O bus and an I&#x2F;O device.</p>
<h3 id="Main-Memory"><a href="#Main-Memory" class="headerlink" title="Main Memory"></a>Main Memory</h3><p>Physically, main memory consists of a collection of dynamic random access memory(DRAM) chips.</p>
<h3 id="Processor"><a href="#Processor" class="headerlink" title="Processor"></a>Processor</h3><p>At CPU’s core is a word-size storage device (or register) called the <em>program counter (PC)</em>. At any point in time, the PC points at (contains the address of) some machine-language instruction in<br>main memory.<br>There are only a few of these simple operations, and they revolve around main memory, the <em>register file</em>, and the <em>arithmetic&#x2F;logic unit (ALU)</em>. The register file is a small storage device that consists of a collection of word-size registers, each with its own unique name. The ALU computes new data and address values.</p>
<p>Here are some examples of the simple operations that the CPU might carry out at the request of an instruction:</p>
<ul>
<li><em>Load</em>: Copy a byte or a word from main memory into a register, overwriting the previous contents of the register.</li>
<li><em>Store</em>: Copy a byte or a word from a register to a location in main memory, overwriting the previous contents of that location.</li>
<li><em>Operate</em>: Copy the contents of two registers to the ALU, perform an arithmetic operation on the two words, and store the result in a register, overwriting the previous contents of that register.</li>
<li><em>Jump</em>: Extract a word from the instruction itself and copy that word into the program counter (PC), overwriting the previous value of the PC.</li>
</ul>
<h2 id="Running-the-hello-Program"><a href="#Running-the-hello-Program" class="headerlink" title="Running the hello Program"></a>Running the <code>hello</code> Program</h2><p><img src="https://s2.loli.net/2024/11/11/WxsiolqVvAM5gnK.png" srcset="/img/loading.gif" lazyload alt="Reading the hello command from the keyboard.png"><br>Initially, the shell program is executing its instructions, waiting for us to type a command. As we type the characters .&#x2F;hello at the keyboard, the shell program reads each one into a register and then stores it in memory.</p>
<p><img src="https://s2.loli.net/2024/11/11/o2yGauFwJnNz1hp.png" srcset="/img/loading.gif" lazyload alt="Loading the executable from disk into main memory.png"><br>When we hit the enter key on the keyboard, the shell knows that we have finished typing the command. The shell then loads the executable hello file by executing a sequence of instructions that copies the code and data in the <code>hello</code> object file from disk to main memory. The data includes the string of characters <code>hello, world\n</code> that will eventually be printed out.</p>
<blockquote>
<p>Using a technique known as <em>direct memory access</em> (DMA, discussed in Chapter 6), the data travel directly from disk to main memory, without passing through the processor.</p>
</blockquote>
<p><img src="https://s2.loli.net/2024/11/11/LtcrOVb4GCAqERT.png" srcset="/img/loading.gif" lazyload alt="image.png"><br>Once the code and data in the <code>hello</code> object file are loaded into memory, the processor begins executing the machine-language instructions in the <code>hello</code> program’s main routine. These instructions copy the bytes in the <code>hello, world\n</code> string from memory to the register file, and from there to the display device, where they are displayed on the screen.</p>
<h1 id="5-Caches-Matter"><a href="#5-Caches-Matter" class="headerlink" title="5. Caches Matter"></a>5. Caches Matter</h1><p>An important lesson from this simple example is that a system spends a lot of time moving information from one place to another. From a programmer’s perspective, much of this copying is overhead that slows down the “real work” of the program. Thus, a major goal for system designers is to make these copy operations run as fast as possible.</p>
<p><img src="https://s2.loli.net/2024/11/11/C1OVGkJTKigyE59.png" srcset="/img/loading.gif" lazyload alt="image.png"><br>System designers include smaller, faster storage devices called <em>cache memories</em> (or simply <em>caches</em>) that serve as temporary staging areas(过渡区) for information that the processor is likely to need in the near future.<br>An L1 cache on the processor chip holds tens of thousands of bytes and can be accessed nearly as fast as the register file. A larger L2 cache with hundreds of thousands to millions of bytes is connected to the processor by a special bus. The L1 and L2 caches are implemented with a hardware technology known as <em>static random access memory (SRAM)</em>. Newer and more powerful systems even have three levels of cache: L1, L2, and L3.</p>
<p>One of the most important lessons in this book is that application programmers who are aware of cache memories can exploit them to improve the performance of their programs by an order of magnitude.</p>
<h1 id="6-Storage-Devices-Form-a-Hierarchy"><a href="#6-Storage-Devices-Form-a-Hierarchy" class="headerlink" title="6. Storage Devices Form a Hierarchy"></a>6. Storage Devices Form a Hierarchy</h1><p><img src="https://s2.loli.net/2024/11/11/rdLDHEoZGb1gyqN.png" srcset="/img/loading.gif" lazyload alt="An example of a memory hierarchy.png"><br>The main idea of a memory hierarchy is that storage at one level serves as a cache for storage at the next lower level.</p>
<h1 id="7-The-Operating-System-Manages-the-Hardware"><a href="#7-The-Operating-System-Manages-the-Hardware" class="headerlink" title="7. The Operating System Manages the Hardware"></a>7. The Operating System Manages the Hardware</h1><p><img src="https://s2.loli.net/2024/11/11/TreJAvIFSuzyXaD.png" srcset="/img/loading.gif" lazyload alt="Layered view of a computer system.png"><br>We can think of the <em>operating system</em> as a layer of software interposed between the application program and the hardware. All attempts by an application program to manipulate the hardware must go through the operating system.</p>
<p>The operating system has two primary purposes: </p>
<ol>
<li>to protect the hardware from misuse by runaway applications;</li>
<li>to provide applications with simple and uniform mechanisms for manipulating complicated and often wildly different low-level hardware devices.</li>
</ol>
<p><img src="https://s2.loli.net/2024/11/11/uQ7vKslaI5O3RHm.png" srcset="/img/loading.gif" lazyload alt="Abstractions provided by an operating system.png"><br>The operating system achieves both goals via the fundamental abstractions: <em>processes</em>, <em>virtual memory</em>, and <em>files</em>. As this figure suggests, files are abstractions for I&#x2F;O devices, virtual memory is an abstraction for both the main memory and disk I&#x2F;O devices, and processes are abstractions for the processor, main memory, and I&#x2F;O devices.</p>
<h2 id="Processes"><a href="#Processes" class="headerlink" title="Processes"></a>Processes</h2><p>A process is the operating system’s abstraction for a running program. Multiple processes can run concurrently on the same system, and each process appears to have exclusive use of the hardware.</p>
<p>Traditional systems could only execute one program at a time, while newer multicore processors can execute several programs simultaneously. In either case, a single CPU can appear to execute multiple processes concurrently by having the processor switch among them. The operating system performs this interleaving with a mechanism known as <em>context switching</em>.<br><img src="https://s2.loli.net/2024/11/11/TduV6kKias2YmyG.png" srcset="/img/loading.gif" lazyload alt="Process context switching.png"></p>
<p>The transition from one process to another is managed by the operating system <em>kernel</em>. The kernel is the portion of the operating system code that is always resident in memory. When an application program requires some action by the operating system, such as to read or write a file, it executes a special system call instruction, transferring control to the kernel.</p>
<blockquote>
<p>Note that the kernel is not a separate process. Instead, it is a collection of code and data structures that the system uses to manage all the processes.</p>
</blockquote>
<h2 id="Threads"><a href="#Threads" class="headerlink" title="Threads"></a>Threads</h2><p>In modern systems a process can actually consist of multiple execution units, called <em>threads</em>,<br>each running in the context of the process and sharing the same code and global data.</p>
<p>It is easier to share data between multiple threads than between multiple processes, and threads are typically more efficient than processes.</p>
<h2 id="Virtual-Memory"><a href="#Virtual-Memory" class="headerlink" title="Virtual Memory"></a>Virtual Memory</h2><p><img src="https://s2.loli.net/2024/11/11/aXsNoH8gtw9OfQu.png" srcset="/img/loading.gif" lazyload alt="Process virtual address space.png"><br>Virtual memory is an abstraction that provides each process with the illusion that it has exclusive use of the main memory. Each process has the same uniform view of memory, which is known as its virtual address space.</p>
<p>In Linux, the topmost region of the address space is reserved for code and data in the operating system that is common to all processes. The lower region of the address space holds the code and data defined by the user’s process.</p>
<ul>
<li><strong>Program code and data.</strong> Code begins at the same fixed address for all processes, followed by data locations that correspond to global C variables. The code and data areas are initialized directly from the contents of an executable object file—in our case, the <code>hello</code> executable.</li>
<li><strong>Heap.</strong> The code and data areas are followed immediately by the run-time heap. Unlike the code and data areas, which are fixed in size once the process begins running, the heap expands and contracts <strong>dynamically</strong> at run time as a result of calls to C standard library routines such as <code>malloc</code> and <code>free</code>.</li>
<li><strong>Shared libraries.</strong> Near the middle of the address space is an area that holds the code and data for shared libraries such as the C standard library and the math library.</li>
<li><strong>Stack.</strong> At the top of the user’s virtual address space is the user stack that the compiler uses to implement function calls. Like the heap, the user stack expands and contracts <strong>dynamically</strong> during the execution of the program. In particular, each time we call a function, the stack grows. Each time we return from a function, it contracts.</li>
<li><strong>Kernel virtual memory.</strong> The top region of the address space is reserved for the kernel. Application programs are not allowed to read or write the contents of this area or to directly call functions defined in the kernel code. Instead, they must <strong>invoke the kernel</strong> to perform these operations.</li>
</ul>
<p>For virtual memory to work, a sophisticated interaction is required between the hardware and the operating system software, including a hardware translation of every address generated by the processor. The basic idea is to <strong>store the contents of a process’s virtual memory on disk and then use the main memory as a cache for the disk.</strong></p>
<h2 id="Files"><a href="#Files" class="headerlink" title="Files"></a>Files</h2><p><strong>A <em>file</em> is a sequence of bytes, nothing more and nothing less.</strong> Every I&#x2F;O device, including disks, keyboards, displays, and even networks, is modeled as a file. All input and output in the system is performed by reading and writing files, using a small set of system calls known as <em>Unix I&#x2F;O</em>.</p>
<h1 id="8-Systems-Communicate-with-Other-Systems-Using-Networks"><a href="#8-Systems-Communicate-with-Other-Systems-Using-Networks" class="headerlink" title="8. Systems Communicate with Other Systems Using Networks"></a>8. Systems Communicate with Other Systems Using Networks</h1><p><img src="https://s2.loli.net/2024/11/11/7hATLe6BakbZHJz.png" srcset="/img/loading.gif" lazyload alt="A network is another I/O device.png"><br>From the point of view of an individual system, the network can be viewed as just another I&#x2F;O device.</p>
<h1 id="9-Important-Themes"><a href="#9-Important-Themes" class="headerlink" title="9. Important Themes"></a>9. Important Themes</h1><h2 id="Amdahl’s-Law"><a href="#Amdahl’s-Law" class="headerlink" title="Amdahl’s Law"></a>Amdahl’s Law</h2><p>Suppose some part of the system requires a fraction <em>α</em> of this time, and that we improve its performance by a factor of <em>k</em>.<br>$$<br>\begin{split}<br>T_{new}&amp;&#x3D;(1-\alpha)T_{old}+(\alpha{T_{old}})&#x2F;k\\<br>T_{new}&amp;&#x3D;T_{old}[(1-\alpha)+\alpha&#x2F;k]\\<br>S &amp;&#x3D; \frac{T_{old}}{T_{new}}\\&amp;&#x3D;\frac{1}{(1-\alpha)+\alpha&#x2F;k}<br>\end{split}<br>$$<br>Set <em>k</em> to ∞, we get<br>$$<br>S_{\infty}&#x3D;\frac{1}{1-\alpha}<br>$$The major insight of Amdahl’s law — to significantly speed up the entire system, we must improve the speed of <strong>a very large fraction of the overall system</strong>.</p>
<h2 id="Concurrency-and-Parallelism"><a href="#Concurrency-and-Parallelism" class="headerlink" title="Concurrency and Parallelism"></a>Concurrency and Parallelism</h2><p>We use the term <em>concurrency</em> to refer to the general concept of a system with multiple, simultaneous activities, and the term <em>parallelism</em> to refer to the use of concurrency to make a system run faster. Parallelism can be exploited at multiple levels of abstraction in a computer system.</p>
<h3 id="Thread-Level-Concurrency"><a href="#Thread-Level-Concurrency" class="headerlink" title="Thread-Level Concurrency"></a>Thread-Level Concurrency</h3><p><img src="https://s2.loli.net/2024/11/11/mSR2lf8VFg56rHX.png" srcset="/img/loading.gif" lazyload alt="Multi-core processor organization.png"><br>Multi-core processors have several CPUs (referred to as “cores”) integrated onto a single integrated-circuit chip. The figure illustrates the organization of a typical multi-core processor, where the chip has four CPU cores, each with its own L1 and L2 caches, and with each L1 cache split into two parts—one to hold recently fetched instructions and one to hold data. The cores share higher levels of cache as well as the interface to main memory.</p>
<p>Hyperthreading, sometimes called simultaneous multi-threading, is a technique that allows a single CPU to execute multiple flows of control.<br>It involves having <strong>multiple copies</strong> of some of the CPU hardware, such as program counters and register files, while having only single copies of other parts of the hardware, such as the units that perform floating-point arithmetic.<br>Whereas a conventional processor requires around 20,000 clock cycles to shift between different threads, a hyperthreaded processor decides which of its threads to execute on a cycle-by-cycle basis. It enables the CPU to take better advantage of its processing resources.</p>
<blockquote>
<p>For example, if one thread must wait for some data to be loaded into a cache, the CPU can proceed with the execution of a different thread.</p>
</blockquote>
<h3 id="Instruction-Level-Parallelism"><a href="#Instruction-Level-Parallelism" class="headerlink" title="Instruction-Level Parallelism"></a>Instruction-Level Parallelism</h3><p>In Chapter 4, we will explore the use of <em>pipelining</em>, where the actions required to execute an instruction are partitioned into different steps and the processor hardware is organized as a series of stages, each performing one of these steps. The stages can operate in parallel, working on different parts of different instructions.</p>
<h3 id="Single-Instruction-Multiple-Data-SIMD-Parallelism"><a href="#Single-Instruction-Multiple-Data-SIMD-Parallelism" class="headerlink" title="Single-Instruction, Multiple-Data (SIMD) Parallelism"></a>Single-Instruction, Multiple-Data (SIMD) Parallelism</h3><p>At the lowest level, many modern processors have special hardware that allows a single instruction to cause multiple operations to be performed in parallel, a mode known as <em>single-instruction, multiple-data (SIMD)</em> parallelism.</p>
<blockquote>
<p>For example, recent generations of Intel and AMD processors have instructions that can add 8 pairs of single-precision floating-point numbers (C data type float) in parallel.</p>
</blockquote>
<p>These SIMD instructions are provided mostly to speed up applications that process image, sound, and video data.</p>
<h2 id="The-Importance-of-Abstractions-in-Computer-Systems"><a href="#The-Importance-of-Abstractions-in-Computer-Systems" class="headerlink" title="The Importance of Abstractions in Computer Systems"></a>The Importance of Abstractions in Computer Systems</h2><p>The use of <em>abstractions</em> is one of the most important concepts in computer science. For example, one aspect of good programming practice is to formulate a simple <em>application program interface (API)</em> for a set of functions that allow programmers to use the code without having to delve into its inner workings.</p>
<p><img src="https://s2.loli.net/2024/11/11/BvuYDbgAySwRjtq.png" srcset="/img/loading.gif" lazyload alt="Some abstractions provided by a computer system.png"></p>
<blockquote>
<p>A major theme in computer systems is to provide abstract representations at different levels to hide the complexity of the actual implementations.</p>
</blockquote>
<p>On the operating system side, we have introduced three abstractions: files as an abstraction of I&#x2F;O devices, virtual memory as an abstraction of program memory, and processes as an abstraction of a running program. To these abstractions we add a new one: the <em>virtual machine</em>, providing an abstraction of the entire computer, including the operating system, the processor, and the programs.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/computer-basics/" class="category-chain-item">computer-basics</a>
  
  
    <span>></span>
    
  <a href="/categories/computer-basics/CSAPP/" class="category-chain-item">CSAPP</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>CSAPP - Chapter 1 - A Tour of Computer Systems</div>
      <div>https://peixuanhu.github.io/posts/ab6f0cb4.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Peixuan Hu</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>November 10, 2024</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Updated on</div>
          <div>May 19, 2025</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/posts/8602d57a.html" title="Shadcn UI 介绍及使用">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Shadcn UI 介绍及使用</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/posts/cd2d07a5.html" title="期权投资策略1 - 期权定义">
                        <span class="hidden-mobile">期权投资策略1 - 期权定义</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'peixuanhu/peixuanhu.github.io');
      s.setAttribute('issue-term', 'pathname');
      
      s.setAttribute('label', 'utterances');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        Views: 
        <span id="busuanzi_value_site_pv"></span>
        
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        Visitors: 
        <span id="busuanzi_value_site_uv"></span>
        
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
