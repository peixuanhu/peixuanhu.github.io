---
title: 设计模式22-桥接模式
categories:
	- Design Pattern
---

# 合成/聚合复用原则 (CARP)

## 定义

合成／聚合复用原则（CARP），尽量使用合成 (Composition)／聚合 (Aggregation)，尽量不要使用类继承。

## 合成和聚合

- 聚合表示一种弱的'拥有'关系，体现的是A对象可以包含B对象，但B对象不是A对象的一部分。
  - 如：大雁是群居动物，所以每只大雁都是属于一个雁群，一个雁群可以有多只大雁，所以大雁和雁群是聚合关系。

- 合成则是一种强的'拥有'关系，体现了严格的部分和整体的关系，部分和整体的生命周期一样。
  - 如：大雁有两个翅膀，翅膀与大雁是部分和整体的关系，并且它们的生命周期是相同的，于是大雁和翅膀就是合成关系。

## 好处

优先使用对象的合成／聚合将有助于你保持每个类被封装，并被集中在单个任务上。这样类和类继承层次会保持较小规模，并且不太可能增长为不可控制的庞然大物。

# 桥接模式

## 定义

桥接模式（Bridge），将抽象部分（如手机品牌）与它的实现部分（如手机软件）分离，使它们都可以独立地变化。

> 什么叫抽象与它的实现分离？这并不是说，让抽象类与其派生类分离，因为这没有任何意义。实现指的是抽象类和它的派生类用来实现自己的对象。
>
> 实现系统可能有多角度分类，每一种分类都有可能变化，那么就把这种多角度分离出来让它们独立变化，减少它们之间的耦合。

## 结构图

![桥接模式结构图.png](https://s2.loli.net/2023/10/26/pstFy3v7dxHa481.png)

## 基本代码

`Implementor` 类：

```java
abstract class Implementor {
  
  public abstract void operation();
}
```

`ConcreteImplementorA`和`ConcreteImplementorB`等派生类：

```java
class ConcreteImplementorA extends Implementor {
  
  public void operation() {
    System.out.println("具体实现A的方法执行");
  }
}

class ConcreteImplementorB extends Implementor {
  
  public void operation() {
    System.out.println("具体实现B的方法执行");
  }
}
```

`Abstraction` 类：

```java
abstract class Abstraction {
  
  protected Implementor implementor;
  
  public void setImplementor(Implementor implementor) {
    this.implementor = implementor;
  }
  
  public abstract void operation();
}
```

`RefinedAbstraction` 类：

```java
class RefinedAbstraction extends Abstraction {
  
  public void operation() {
    System.out.print("具体的Abstraction");
    implementor.operation();
  }
}
```

客户端代码：

```java
Abstraction ab;
ab = new RefinedAbstraction();

ab.setImplementor(new ConcreteImplementorA());
ab.operation();

ab.setImplementor(new ConcreteImplementorB());
ab.operation();
```

