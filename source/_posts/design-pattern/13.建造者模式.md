---
title: 设计模式13-建造者模式
categories:
	- Design Pattern
---

# 建造者模式

## 定义

建造者模式（Builder），将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。

建造者模式可以将一个产品的**内部表象**与产品的**生成过程**分割开来，从而可以使一个建造过程生成具有不同的内部表象的产品对象。

用户只需指定需要建造的类型即可，不需要知道具体建造的过程和细节。

## 结构图

![建造者模式结构图.jpg](https://s2.loli.net/2023/10/10/9L64AUgXlocTGOB.jpg)

### Director

构建一个使用 `Builder` 接口的对象。

用于控制建造过程，隔离用户与建造过程的关联。

### Builder

为创建一个 `Product` 对象的各个部件指定的抽象接口。

### ConcreteBuilder

具体建造者，实现 `Builder` 接口，构造和装配各个部件。

### Product

`Builder` 建造出来的具体产品。

## 基本代码

`Product` 类：产品类，由多个部件组成

```java
class Product {
  
  ArrayList<String> parts = new ArrayList<String>();
  
  // 添加新的产品部件
  public void add(String part) {
    parts.add(part);
  }
  
  // 列举所有产品部件
  public void show() {
    for (String part : parts) {
      System.out.println(part);
    }
  }
}
```

`Builder` 类：抽象建造者类，确定产品由两个部件 `PartA` 和 `PartB` 组成，并声明一个得到产品建造后结果的方法 `GetResult` 。

```java
abstract class Builder {
  public abstract void buildPartA();
  public abstract void buildPartB();
  public abstract Product getResult();
}
```

`ConcreteBuilder` 类：具体建造者类。

```java
// 具体建造者类1
class ConcreteBuilder1 extends Builder {
  private Product product = new Product();
  
  public void buildPartA() {
    product.add("部件A-1");
  }
  
  public void buildPartB() {
    product.add("部件B-1");
  }
  
  public Product getResult() {
    return product;
  }
}

// 具体建造者类2
class ConcreteBuilder2 extends Builder {
  private Product product = new Product();
  
  public void buildPartA() {
    product.add("部件A-2");
  }
  
  public void buildPartB() {
    product.add("部件B-2");
  }
  
  public Product getResult() {
    return product;
  }
}
```

`Director` 类：

```java
class Director {
  
  public void construct(Builder builder) {
    builder.buildPartA();
    builder.buildPartB();
  }
}
```

客户端代码：客户不需要知道具体的建造过程

```java
Director director = new Director();
Builder b1 = new ConcreteBuilder1();
Builder b2 = new ConcreteBuilder2();

// 指挥者用ConcreteBuilder1的方法来建造产品
director.construct(b1);
Product p1 = b1.getResult();
p1.show();

// 指挥者用ConcreteBuilder2的方法来建造产品
director.construct(b2);
Product p2 = b2.getResult();
p2.show();

// p1, p2结果不同
```



## 使用场景

建造者模式主要用于创建一些复杂的对象，这些对象内部子对象的建造顺序通常是稳定的，但每个子对象的构建通常面临复杂的变化。

建造者模式是在当**创建复杂对象的算法**应该独立于**该对象的组成部分**以及**它们的装配方式**时适用的模式。

